openapi: 3.0.3
info:
  title: Basita API Gateway - CMS Endpoints
  description: |
    API Gateway for CMS (Content Management System) operations including advertisements, brands, and car models.

    ## Internationalization
    All endpoints support multiple languages via the `Accept-Language` header.
    Supported languages: en (English), ar (Arabic).
    Default: en

    Example: `Accept-Language: ar`
  version: 1.0.0
  contact:
    name: API Support

servers:
  - url: http://localhost:3001
    description: Local development server

tags:
  - name: Health
    description: Health check endpoint
  - name: Initialization
    description: Application initialization endpoint
  - name: Authentication
    description: User authentication and authorization endpoints (proxied to auth service)
  - name: Advertisements
    description: Advertisement management endpoints
  - name: Brands
    description: Brand management endpoints
  - name: Car Models
    description: Car model management endpoints
  - name: Showrooms
    description: Showroom management endpoints

paths:
  /health:
    get:
      tags:
        - Health
      summary: Health check
      description: Returns the health status of the API Gateway service
      operationId: getHealth
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Health'
              example:
                status: "ok"
                service: "api-gateway"

  /api/init:
    get:
      tags:
        - Initialization
      summary: Initialize application data
      description: Fetches initial data required for the application including governorates, app version, brands, and advertisements in parallel. This endpoint is optimized for performance and returns all data in a single request.
      operationId: initializeApp
      parameters:
        - $ref: '#/components/parameters/AcceptLanguage'
      responses:
        '200':
          description: Successful response with all initial data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InitResponse'
              example:
                governorates:
                  - id: "gov123"
                    name: "Cairo"
                    cities:
                      - id: "city1"
                        name: "Nasr City"
                      - id: "city2"
                        name: "Heliopolis"
                appVersion:
                  mobileAppVersion: "1.0.0"
                  mobileAppBuildNumber: 1
                  webVersion: "1.2.0"
                brands:
                  - id: "ickxh9k2oiqsy90ms7hdxtl6"
                    title: "Toyota"
                    thumbnail:
                      id: "ky89f23cr0v1wbq5a7kgo4le"
                      width: 1342
                      height: 1100
                      url: "http://localhost:3001/uploads/toyota_logo_png_1_d871d2a03a.png"
                advertisements:
                  - id: "zcp8md8k7nrciuwqcc083o5b"
                    action: "brand/1"
                    banner:
                      id: "ky89f23cr0v1wbq5a7kgo4le"
                      width: 1342
                      height: 1100
                      url: "http://localhost:3001/uploads/toyota_logo_png_1_d871d2a03a.png"
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/auth/sign-up/email:
    post:
      tags:
        - Authentication
      summary: Sign up with email and password
      description: Register a new user account using email and password
      operationId: signUpEmail
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - password
                - name
              properties:
                email:
                  type: string
                  format: email
                  example: "user@example.com"
                password:
                  type: string
                  format: password
                  minLength: 8
                  example: "SecurePass123!"
                name:
                  type: string
                  example: "John Doe"
      responses:
        '200':
          description: Successfully registered
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
        '400':
          description: Invalid input or email already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/auth/sign-in/email:
    post:
      tags:
        - Authentication
      summary: Sign in with email and password
      description: Authenticate user with email and password
      operationId: signInEmail
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - password
              properties:
                email:
                  type: string
                  format: email
                  example: "user@example.com"
                password:
                  type: string
                  format: password
                  example: "SecurePass123!"
      responses:
        '200':
          description: Successfully authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
        '401':
          description: Invalid credentials
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/auth/sign-out:
    post:
      tags:
        - Authentication
      summary: Sign out
      description: Sign out the current user and invalidate the session
      operationId: signOut
      responses:
        '200':
          description: Successfully signed out
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true

  /api/auth/forget-password:
    post:
      tags:
        - Authentication
      summary: Request password reset
      description: Send password reset email to the user
      operationId: forgetPassword
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
              properties:
                email:
                  type: string
                  format: email
                  example: "user@example.com"
      responses:
        '200':
          description: Password reset email sent
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true

  /api/auth/reset-password:
    post:
      tags:
        - Authentication
      summary: Reset password
      description: Reset user password with token from email
      operationId: resetPassword
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - token
                - newPassword
              properties:
                token:
                  type: string
                  example: "reset_token_here"
                newPassword:
                  type: string
                  format: password
                  minLength: 8
                  example: "NewSecurePass123!"
      responses:
        '200':
          description: Password successfully reset
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
        '400':
          description: Invalid or expired token
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/auth/sign-in/google:
    get:
      tags:
        - Authentication
      summary: Sign in with Google
      description: Initiates Google OAuth sign-in flow
      operationId: signInGoogle
      responses:
        '302':
          description: Redirects to Google OAuth consent page
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/auth/callback/google:
    get:
      tags:
        - Authentication
      summary: Google OAuth callback
      description: Handles the callback from Google OAuth
      operationId: googleCallback
      parameters:
        - name: code
          in: query
          description: Authorization code from Google
          required: true
          schema:
            type: string
        - name: state
          in: query
          description: State parameter for CSRF protection
          required: false
          schema:
            type: string
      responses:
        '302':
          description: Redirects to application with session
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/auth/sign-in/apple:
    get:
      tags:
        - Authentication
      summary: Sign in with Apple
      description: Initiates Apple OAuth sign-in flow
      operationId: signInApple
      responses:
        '302':
          description: Redirects to Apple OAuth consent page
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/auth/callback/apple:
    post:
      tags:
        - Authentication
      summary: Apple OAuth callback
      description: Handles the callback from Apple OAuth
      operationId: appleCallback
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                code:
                  type: string
                  description: Authorization code from Apple
                state:
                  type: string
                  description: State parameter for CSRF protection
                user:
                  type: string
                  description: User information from Apple (first sign-in only)
      responses:
        '302':
          description: Redirects to application with session
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/auth/get-session:
    get:
      tags:
        - Authentication
      summary: Get current session
      description: Retrieves the current user session information
      operationId: getSession
      responses:
        '200':
          description: Current session information
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Session'
        '401':
          description: Not authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/cms/advertisements:
    get:
      tags:
        - Advertisements
      summary: Get all advertisements
      description: Retrieves a list of all advertisements with their banners
      operationId: getAdvertisements
      parameters:
        - $ref: '#/components/parameters/AcceptLanguage'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Advertisement'
              example:
                - id: "zcp8md8k7nrciuwqcc083o5b"
                  action: "brand/1"
                  banner:
                    id: "ky89f23cr0v1wbq5a7kgo4le"
                    width: 1342
                    height: 1100
                    url: "http://localhost:3001/uploads/toyota_logo_png_1_d871d2a03a.png"
                    formats:
                      thumbnail:
                        width: 190
                        height: 156
                        url: "http://localhost:3001/uploads/thumbnail_toyota_logo_png_1_d871d2a03a.png"
                      small:
                        width: 500
                        height: 410
                        url: "http://localhost:3001/uploads/small_toyota_logo_png_1_d871d2a03a.png"
                      medium:
                        width: 750
                        height: 615
                        url: "http://localhost:3001/uploads/medium_toyota_logo_png_1_d871d2a03a.png"
                      large:
                        width: 1000
                        height: 820
                        url: "http://localhost:3001/uploads/large_toyota_logo_png_1_d871d2a03a.png"
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/cms/advertisements/{id}:
    get:
      tags:
        - Advertisements
      summary: Get advertisement by ID
      description: Retrieves a single advertisement by its document ID
      operationId: getAdvertisementById
      parameters:
        - name: id
          in: path
          required: true
          description: The advertisement document ID
          schema:
            type: string
          example: "zcp8md8k7nrciuwqcc083o5b"
        - $ref: '#/components/parameters/AcceptLanguage'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Advertisement'
        '404':
          description: Advertisement not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/cms/brands:
    get:
      tags:
        - Brands
      summary: Get all brands
      description: Retrieves a simplified list of all brands with their logos
      operationId: getBrands
      parameters:
        - $ref: '#/components/parameters/AcceptLanguage'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/SimpleBrand'
              example:
                - id: "ickxh9k2oiqsy90ms7hdxtl6"
                  title: "Toyota"
                  thumbnail:
                    id: "ky89f23cr0v1wbq5a7kgo4le"
                    width: 1342
                    height: 1100
                    url: "http://localhost:3001/uploads/toyota_logo_png_1_d871d2a03a.png"
                    formats:
                      thumbnail:
                        width: 190
                        height: 156
                        url: "http://localhost:3001/uploads/thumbnail_toyota_logo_png_1_d871d2a03a.png"
                      small:
                        width: 500
                        height: 410
                        url: "http://localhost:3001/uploads/small_toyota_logo_png_1_d871d2a03a.png"
                      medium:
                        width: 750
                        height: 615
                        url: "http://localhost:3001/uploads/medium_toyota_logo_png_1_d871d2a03a.png"
                      large:
                        width: 1000
                        height: 820
                        url: "http://localhost:3001/uploads/large_toyota_logo_png_1_d871d2a03a.png"
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/cms/brands/{id}:
    get:
      tags:
        - Brands
      summary: Get brand by ID
      description: Retrieves a single brand by its document ID
      operationId: getBrandById
      parameters:
        - name: id
          in: path
          required: true
          description: The brand document ID
          schema:
            type: string
          example: "ickxh9k2oiqsy90ms7hdxtl6"
        - $ref: '#/components/parameters/AcceptLanguage'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SimpleBrand'
        '404':
          description: Brand not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/cms/brands/{id}/cars:
    get:
      tags:
        - Car Models
      summary: Get car models by brand ID
      description: Retrieves all car models for a specific brand with pricing information
      operationId: getCarModelsByBrand
      parameters:
        - name: id
          in: path
          required: true
          description: The brand document ID
          schema:
            type: string
          example: "ickxh9k2oiqsy90ms7hdxtl6"
        - $ref: '#/components/parameters/AcceptLanguage'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/SimpleCarModel'
              example:
                - id: "xtvnanfg7cmvws9llx2co0f9"
                  title: "Corolla"
                  thumbnail:
                    id: "ky89f23cr0v1wbq5a7kgo4le"
                    width: 1342
                    height: 1100
                    url: "http://localhost:3001/uploads/toyota_logo_png_1_d871d2a03a.png"
                    formats:
                      thumbnail:
                        width: 190
                        height: 156
                        url: "http://localhost:3001/uploads/thumbnail_toyota_logo_png_1_d871d2a03a.png"
                      small:
                        width: 500
                        height: 410
                        url: "http://localhost:3001/uploads/small_toyota_logo_png_1_d871d2a03a.png"
                      medium:
                        width: 750
                        height: 615
                        url: "http://localhost:3001/uploads/medium_toyota_logo_png_1_d871d2a03a.png"
                      large:
                        width: 1000
                        height: 820
                        url: "http://localhost:3001/uploads/large_toyota_logo_png_1_d871d2a03a.png"
                  pricefrom: 1300000
                  priceto: 1300000
                  marketpricefrom: 1320000
                  marketpriceto: 1320000
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/cms/showrooms:
    get:
      tags:
        - Showrooms
      summary: Get all showrooms
      description: Retrieves a list of all showrooms with their details
      operationId: getShowrooms
      parameters:
        - $ref: '#/components/parameters/AcceptLanguage'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Showroom'
              example:
                - id: "uhw6ascspyb2ofunrn8arp5g"
                  name: "elemam"
                  description: "Premium car dealership"
                  isVerified: true
                  isFeatured: true
                  logo:
                    id: "w2iuapmcja2xdrligu0huj8n"
                    width: 24
                    height: 24
                    url: "http://localhost:3001/uploads/new_car_59bca33b34.svg"
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/cms/showrooms/{id}:
    get:
      tags:
        - Showrooms
      summary: Get showroom by ID
      description: Retrieves detailed information about a specific showroom including location and contact info
      operationId: getShowroomById
      parameters:
        - name: id
          in: path
          required: true
          description: The showroom document ID
          schema:
            type: string
          example: "uhw6ascspyb2ofunrn8arp5g"
        - $ref: '#/components/parameters/AcceptLanguage'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DetailedShowroom'
        '404':
          description: Showroom not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/cms/showrooms/{id}/variants:
    get:
      tags:
        - Showrooms
      summary: Get car variants by showroom ID
      description: Retrieves all car variants available at a specific showroom with pricing information
      operationId: getVariantsByShowroom
      parameters:
        - name: id
          in: path
          required: true
          description: The showroom document ID
          schema:
            type: string
          example: "uhw6ascspyb2ofunrn8arp5g"
        - $ref: '#/components/parameters/AcceptLanguage'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ShowroomVariant'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/cms/cars/{id}:
    get:
      tags:
        - Car Models
      summary: Get detailed car model by ID
      description: Retrieves detailed information about a specific car model including variants, showrooms, reviews, and catalogs
      operationId: getCarModelById
      parameters:
        - name: id
          in: path
          required: true
          description: The car model document ID
          schema:
            type: string
          example: "xtvnanfg7cmvws9llx2co0f9"
        - $ref: '#/components/parameters/AcceptLanguage'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DetailedCarModel'
              example:
                id: "xtvnanfg7cmvws9llx2co0f9"
                title: "Corolla"
                images:
                  - id: "ky89f23cr0v1wbq5a7kgo4le"
                    width: 1342
                    height: 1100
                    url: "http://localhost:3001/uploads/toyota_logo_png_1_d871d2a03a.png"
                    formats:
                      thumbnail:
                        width: 190
                        height: 156
                        url: "http://localhost:3001/uploads/thumbnail_toyota_logo_png_1_d871d2a03a.png"
                      small:
                        width: 500
                        height: 410
                        url: "http://localhost:3001/uploads/small_toyota_logo_png_1_d871d2a03a.png"
                      medium:
                        width: 750
                        height: 615
                        url: "http://localhost:3001/uploads/medium_toyota_logo_png_1_d871d2a03a.png"
                      large:
                        width: 1000
                        height: 820
                        url: "http://localhost:3001/uploads/large_toyota_logo_png_1_d871d2a03a.png"
                  - id: "i847v4mpb8rp9i6zmru5w4sk"
                    width: 24
                    height: 24
                    url: "http://localhost:3001/uploads/used_car_6fc1cfcb35.svg"
                pricefrom: 1300000
                priceto: 1300000
                marketpricefrom: 1320000
                marketpriceto: 1320000
                mindownpayment: 450000
                mininstallments: 35000
                warranty: "3years/100000KM"
                variants:
                  - id: "r3q8tcnki4uy1qpjn2x5lo6d"
                    year: 2025
                    title: "Automatic/Active"
                    cc: "1600CC"
                    price: 1300000
                showrooms:
                  - id: "uhw6ascspyb2ofunrn8arp5g"
                    title: "elemam"
                    thumbnail:
                      id: "w2iuapmcja2xdrligu0huj8n"
                      width: 24
                      height: 24
                      url: "http://localhost:3001/uploads/new_car_59bca33b34.svg"
                    price: 1350000
                    mindownpayment: 450000
                    mininstallments: 35000
                reviews:
                  - id: 1
                    youtubeurl: "https://localhost:3000/api"
                catalogs:
                  - id: 1
                    downloadurl: "https://localhost:3000/api"
        '404':
          description: Car model not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/cms/cars/{carId}/variants/{variantId}:
    get:
      tags:
        - Car Models
      summary: Get detailed variant by ID
      description: Retrieves detailed information about a specific car variant including specs, features, showrooms, review, and catalog
      operationId: getVariantById
      parameters:
        - name: carId
          in: path
          required: true
          description: The car model document ID
          schema:
            type: string
          example: "xtvnanfg7cmvws9llx2co0f9"
        - name: variantId
          in: path
          required: true
          description: The variant document ID
          schema:
            type: string
          example: "r3q8tcnki4uy1qpjn2x5lo6d"
        - $ref: '#/components/parameters/AcceptLanguage'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DetailedVariant'
              example:
                id: "r3q8tcnki4uy1qpjn2x5lo6d"
                title: "Automatic/Active"
                images:
                  - id: "ky89f23cr0v1wbq5a7kgo4le"
                    width: 1342
                    height: 1100
                    url: "http://localhost:3001/uploads/toyota_logo_png_1_d871d2a03a.png"
                    formats:
                      thumbnail:
                        width: 190
                        height: 156
                        url: "http://localhost:3001/uploads/thumbnail_toyota_logo_png_1_d871d2a03a.png"
                pricefrom: 1300000
                priceto: 1300000
                marketpricefrom: 1320000
                marketpriceto: 1320000
                mindownpayment: 450000
                mininstallments: 35000
                warranty: "3years/100000KM"
                model:
                  id: "xtvnanfg7cmvws9llx2co0f9"
                  title: "Corolla"
                showrooms:
                  - id: "uhw6ascspyb2ofunrn8arp5g"
                    title: "elemam"
                    thumbnail:
                      id: "w2iuapmcja2xdrligu0huj8n"
                      width: 24
                      height: 24
                      url: "http://localhost:3001/uploads/new_car_59bca33b34.svg"
                    price: 1350000
                    mindownpayment: 450000
                    mininstallments: 35000
                review:
                  id: 1
                  youtubeurl: "https://localhost:3000/api"
                catalog:
                  id: 1
                  downloadurl: "https://localhost:3000/api"
                specs:
                  - id: 1
                    label: "Motor"
                    value: "1600CC"
                  - id: 2
                    label: "Transmission"
                    value: "CVT"
                  - id: 3
                    label: "Acceleration"
                    value: "12"
                  - id: 4
                    label: "AssembledIn"
                    value: "Turkey"
                  - id: 5
                    label: "GroundClearanceInMM"
                    value: "164"
                  - id: 6
                    label: "HeightInMM"
                    value: "1435"
                  - id: 7
                    label: "Horsepower"
                    value: "120"
                  - id: 8
                    label: "LengthInMM"
                    value: "4630"
                  - id: 9
                    label: "LiterPerKM"
                    value: "6.80"
                  - id: 10
                    label: "MaxSpeed"
                    value: "189"
                  - id: 11
                    label: "Origin"
                    value: "Japan"
                  - id: 12
                    label: "Speed"
                    value: "4"
                  - id: 13
                    label: "TractionType"
                    value: "Front Traction"
                  - id: 14
                    label: "TrunkSize"
                    value: "470"
                  - id: 15
                    label: "WheelBase"
                    value: "2700"
                  - id: 16
                    label: "WidthInMM"
                    value: "1780"
                  - id: 17
                    label: "Seats"
                    value: "5"
                features:
                  - id: 1
                    label: "Power Steering"
                    value: ""
                  - id: 2
                    label: "Air Conditioning"
                    value: ""
                  - id: 3
                    label: "Electric mirrors"
                    value: ""
        '404':
          description: Variant not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

components:
  parameters:
    AcceptLanguage:
      name: Accept-Language
      in: header
      description: Language preference for localized content
      required: false
      schema:
        type: string
        enum:
          - en
          - ar
        default: en
        example: ar

  schemas:
    MediaFormat:
      type: object
      description: Represents a specific image format/size
      required:
        - width
        - height
        - url
      properties:
        width:
          type: integer
          description: Image width in pixels
          example: 190
        height:
          type: integer
          description: Image height in pixels
          example: 156
        url:
          type: string
          format: uri
          description: Full URL to the image (prefixed with base URL)
          example: "http://localhost:3001/uploads/thumbnail_toyota_logo_png_1_d871d2a03a.png"

    MediaFormats:
      type: object
      description: Contains different sizes of media files
      properties:
        thumbnail:
          $ref: '#/components/schemas/MediaFormat'
        small:
          $ref: '#/components/schemas/MediaFormat'
        medium:
          $ref: '#/components/schemas/MediaFormat'
        large:
          $ref: '#/components/schemas/MediaFormat'

    MediaField:
      type: object
      description: Simplified Strapi media field with essential data
      required:
        - id
        - url
      properties:
        id:
          type: string
          description: Document ID from Strapi
          example: "ky89f23cr0v1wbq5a7kgo4le"
        width:
          type: integer
          description: Original image width in pixels
          example: 1342
        height:
          type: integer
          description: Original image height in pixels
          example: 1100
        url:
          type: string
          format: uri
          description: Full URL to the media file (prefixed with base URL)
          example: "http://localhost:3001/uploads/toyota_logo_png_1_d871d2a03a.png"
        formats:
          $ref: '#/components/schemas/MediaFormats'

    Advertisement:
      type: object
      description: Advertisement with banner image
      required:
        - id
        - action
      properties:
        id:
          type: string
          description: Advertisement document ID
          example: "zcp8md8k7nrciuwqcc083o5b"
        action:
          type: string
          description: Action identifier (e.g., brand/1)
          example: "brand/1"
        banner:
          $ref: '#/components/schemas/MediaField'

    SimpleBrand:
      type: object
      description: Simplified brand representation
      required:
        - id
        - title
      properties:
        id:
          type: string
          description: Brand document ID
          example: "ickxh9k2oiqsy90ms7hdxtl6"
        title:
          type: string
          description: Brand name
          example: "Toyota"
        thumbnail:
          $ref: '#/components/schemas/MediaField'

    Showroom:
      type: object
      description: Showroom with basic information
      required:
        - id
        - name
        - isVerified
        - isFeatured
      properties:
        id:
          type: string
          description: Showroom document ID
          example: "uhw6ascspyb2ofunrn8arp5g"
        name:
          type: string
          description: Showroom name
          example: "elemam"
        description:
          type: string
          description: Showroom description
          example: "Premium car dealership"
        isVerified:
          type: boolean
          description: Whether the showroom is verified
          example: true
        isFeatured:
          type: boolean
          description: Whether the showroom is featured
          example: true
        logo:
          $ref: '#/components/schemas/MediaField'

    DetailedShowroom:
      type: object
      description: Showroom with full details including location and contact info
      required:
        - id
        - name
        - isVerified
        - isFeatured
      properties:
        id:
          type: string
          description: Showroom document ID
          example: "uhw6ascspyb2ofunrn8arp5g"
        name:
          type: string
          description: Showroom name
          example: "elemam"
        description:
          type: string
          description: Showroom description
          example: "Premium car dealership"
        isVerified:
          type: boolean
          description: Whether the showroom is verified
          example: true
        isFeatured:
          type: boolean
          description: Whether the showroom is featured
          example: true
        logo:
          $ref: '#/components/schemas/MediaField'
        cover:
          $ref: '#/components/schemas/MediaField'
        operatingHours:
          type: string
          description: Operating hours
          example: "Sun-Thu: 9AM-8PM, Fri-Sat: 10AM-6PM"
        location:
          $ref: '#/components/schemas/Location'
        contactInfo:
          $ref: '#/components/schemas/ContactInfo'

    Location:
      type: object
      description: Location details for a showroom
      properties:
        address:
          type: string
          description: Street address
          example: "123 Main Street"
        governorate:
          $ref: '#/components/schemas/Governorate'
        city:
          $ref: '#/components/schemas/City'
        latitude:
          type: number
          format: double
          description: GPS latitude
          example: 30.0444
        longitude:
          type: number
          format: double
          description: GPS longitude
          example: 31.2357

    Governorate:
      type: object
      description: Governorate/State information
      required:
        - id
        - name
      properties:
        id:
          type: string
          description: Governorate document ID
          example: "gov123"
        name:
          type: string
          description: Governorate name
          example: "Cairo"

    City:
      type: object
      description: City information
      required:
        - id
        - name
      properties:
        id:
          type: string
          description: City document ID
          example: "city456"
        name:
          type: string
          description: City name
          example: "Nasr City"

    ContactInfo:
      type: object
      description: Contact information for a showroom
      properties:
        email:
          type: string
          format: email
          description: Email address
          example: "info@elemam.com"
        phone:
          type: string
          description: Phone number
          example: "+20 123 456 7890"
        facebook:
          type: string
          format: uri
          description: Facebook URL
          example: "https://facebook.com/elemam"
        instagram:
          type: string
          format: uri
          description: Instagram URL
          example: "https://instagram.com/elemam"
        tiktok:
          type: string
          format: uri
          description: TikTok URL
          example: "https://tiktok.com/@elemam"
        whatsapp:
          type: string
          description: WhatsApp number
          example: "+20 123 456 7890"
        x:
          type: string
          format: uri
          description: X (Twitter) URL
          example: "https://x.com/elemam"
        youtube:
          type: string
          format: uri
          description: YouTube URL
          example: "https://youtube.com/@elemam"
        websiteURL:
          type: string
          format: uri
          description: Website URL
          example: "https://elemam.com"

    ShowroomVariant:
      type: object
      description: Car variant available at a specific showroom
      required:
        - id
        - displayName
        - price
      properties:
        id:
          type: string
          description: Variant document ID
          example: "r3q8tcnki4uy1qpjn2x5lo6d"
        displayName:
          type: string
          description: Display name of the variant
          example: "Corolla 2025 Automatic/Active"
        images:
          type: array
          description: Array of variant images
          items:
            $ref: '#/components/schemas/MediaField'
        price:
          type: integer
          description: Showroom price for the variant
          example: 1350000
        minDownPayment:
          type: integer
          description: Minimum down payment
          example: 450000
        minInstallments:
          type: integer
          description: Minimum monthly installment
          example: 35000

    SimpleCarModel:
      type: object
      description: Simplified car model with pricing
      required:
        - id
        - title
      properties:
        id:
          type: string
          description: Car model document ID
          example: "xtvnanfg7cmvws9llx2co0f9"
        title:
          type: string
          description: Car model name
          example: "Corolla"
        thumbnail:
          $ref: '#/components/schemas/MediaField'
        pricefrom:
          type: integer
          description: Minimum price
          example: 1300000
        priceto:
          type: integer
          description: Maximum price
          example: 1300000
        marketpricefrom:
          type: integer
          description: Minimum market price
          example: 1320000
        marketpriceto:
          type: integer
          description: Maximum market price
          example: 1320000

    SimpleVariant:
      type: object
      description: Car variant information
      required:
        - id
        - year
        - title
        - price
      properties:
        id:
          type: string
          description: Variant document ID
          example: "r3q8tcnki4uy1qpjn2x5lo6d"
        year:
          type: integer
          description: Model year
          example: 2025
        title:
          type: string
          description: Variant name
          example: "Automatic/Active"
        cc:
          type: string
          description: Engine capacity
          example: "1600CC"
        price:
          type: integer
          description: Variant price
          example: 1300000

    SimpleShowroom:
      type: object
      description: Showroom with pricing information
      required:
        - id
        - title
        - price
      properties:
        id:
          type: string
          description: Showroom document ID
          example: "uhw6ascspyb2ofunrn8arp5g"
        title:
          type: string
          description: Showroom name
          example: "elemam"
        thumbnail:
          $ref: '#/components/schemas/MediaField'
        price:
          type: integer
          description: Showroom price for the car
          example: 1350000
        mindownpayment:
          type: integer
          description: Minimum down payment
          example: 450000
        mininstallments:
          type: integer
          description: Minimum monthly installment
          example: 35000

    ReviewItem:
      type: object
      description: Review video information
      required:
        - id
        - youtubeurl
      properties:
        id:
          type: integer
          description: Review ID
          example: 1
        youtubeurl:
          type: string
          format: uri
          description: YouTube video URL
          example: "https://localhost:3000/api"

    CatalogItem:
      type: object
      description: Catalog/brochure download information
      required:
        - id
        - downloadurl
      properties:
        id:
          type: integer
          description: Catalog ID
          example: 1
        downloadurl:
          type: string
          format: uri
          description: Download URL for the catalog
          example: "https://localhost:3000/api"

    DetailedCarModel:
      type: object
      description: Detailed car model with all related information
      required:
        - id
        - title
      properties:
        id:
          type: string
          description: Car model document ID
          example: "xtvnanfg7cmvws9llx2co0f9"
        title:
          type: string
          description: Car model name
          example: "Corolla"
        images:
          type: array
          description: Array of car images
          items:
            $ref: '#/components/schemas/MediaField'
        pricefrom:
          type: integer
          description: Minimum price
          example: 1300000
        priceto:
          type: integer
          description: Maximum price
          example: 1300000
        marketpricefrom:
          type: integer
          description: Minimum market price
          example: 1320000
        marketpriceto:
          type: integer
          description: Maximum market price
          example: 1320000
        mindownpayment:
          type: integer
          description: Minimum down payment
          example: 450000
        mininstallments:
          type: integer
          description: Minimum monthly installment
          example: 35000
        warranty:
          type: string
          description: Warranty information
          example: "3years/100000KM"
        variants:
          type: array
          description: Available variants
          items:
            $ref: '#/components/schemas/SimpleVariant'
        showrooms:
          type: array
          description: Showrooms selling this car
          items:
            $ref: '#/components/schemas/SimpleShowroom'
        reviews:
          type: array
          description: Review videos
          items:
            $ref: '#/components/schemas/ReviewItem'
        catalogs:
          type: array
          description: Downloadable catalogs/brochures
          items:
            $ref: '#/components/schemas/CatalogItem'

    Health:
      type: object
      description: Health check response
      required:
        - status
        - service
      properties:
        status:
          type: string
          description: Service health status
          example: "ok"
        service:
          type: string
          description: Service name
          example: "api-gateway"

    InitResponse:
      type: object
      description: Combined response containing all initial application data
      properties:
        governorates:
          type: array
          description: List of governorates with their cities
          items:
            $ref: '#/components/schemas/GovernorateWithCities'
        appVersion:
          $ref: '#/components/schemas/ApplicationVersion'
        brands:
          type: array
          description: List of brands
          items:
            $ref: '#/components/schemas/SimpleBrand'
        advertisements:
          type: array
          description: List of advertisements
          items:
            $ref: '#/components/schemas/Advertisement'

    GovernorateWithCities:
      type: object
      description: Governorate with its cities
      required:
        - id
        - name
        - cities
      properties:
        id:
          type: string
          description: Governorate document ID
          example: "gov123"
        name:
          type: string
          description: Governorate name
          example: "Cairo"
        cities:
          type: array
          description: List of cities in this governorate
          items:
            $ref: '#/components/schemas/City'

    ApplicationVersion:
      type: object
      description: Application version information
      required:
        - mobileAppVersion
        - mobileAppBuildNumber
        - webVersion
      properties:
        mobileAppVersion:
          type: string
          description: Mobile app version
          example: "1.0.0"
        mobileAppBuildNumber:
          type: integer
          description: Mobile app build number
          example: 1
        webVersion:
          type: string
          description: Web version
          example: "1.2.0"

    SimpleCarModelRef:
      type: object
      description: Simplified reference to a car model
      required:
        - id
        - title
      properties:
        id:
          type: string
          description: Car model document ID
          example: "xtvnanfg7cmvws9llx2co0f9"
        title:
          type: string
          description: Car model name
          example: "Corolla"

    SpecItem:
      type: object
      description: Specification item for a variant (values are converted to strings from mixed types)
      required:
        - id
        - label
        - value
      properties:
        id:
          type: integer
          description: Spec item ID (auto-incremented)
          example: 1
        label:
          type: string
          description: Specification label
          enum:
            - Motor
            - Transmission
            - Acceleration
            - AssembledIn
            - GroundClearanceInMM
            - HeightInMM
            - Horsepower
            - LengthInMM
            - LiterPerKM
            - MaxSpeed
            - Origin
            - Speed
            - TractionType
            - TrunkSize
            - WheelBase
            - WidthInMM
            - Seats
          example: "Motor"
        value:
          type: string
          description: Specification value (converted to string, may be numeric or text)
          example: "1600CC"

    FeatureItem:
      type: object
      description: Feature item for a variant (typically from a simple string array)
      required:
        - id
        - label
      properties:
        id:
          type: integer
          description: Feature item ID (auto-incremented)
          example: 1
        label:
          type: string
          description: Feature name/label
          example: "Power Steering"
        value:
          type: string
          description: Feature value (typically empty for simple feature lists)
          example: ""

    DetailedVariant:
      type: object
      description: Detailed variant with all information including specs and features
      required:
        - id
        - title
      properties:
        id:
          type: string
          description: Variant document ID
          example: "r3q8tcnki4uy1qpjn2x5lo6d"
        title:
          type: string
          description: Variant name
          example: "Automatic/Active"
        images:
          type: array
          description: Array of variant/model images
          items:
            $ref: '#/components/schemas/MediaField'
        pricefrom:
          type: integer
          description: Minimum price
          example: 1300000
        priceto:
          type: integer
          description: Maximum price
          example: 1300000
        marketpricefrom:
          type: integer
          description: Minimum market price
          example: 1320000
        marketpriceto:
          type: integer
          description: Maximum market price
          example: 1320000
        mindownpayment:
          type: integer
          description: Minimum down payment
          example: 450000
        mininstallments:
          type: integer
          description: Minimum monthly installment
          example: 35000
        warranty:
          type: string
          description: Warranty information
          example: "3years/100000KM"
        model:
          $ref: '#/components/schemas/SimpleCarModelRef'
        showrooms:
          type: array
          description: Showrooms selling this variant
          items:
            $ref: '#/components/schemas/SimpleShowroom'
        review:
          $ref: '#/components/schemas/ReviewItem'
        catalog:
          $ref: '#/components/schemas/CatalogItem'
        specs:
          type: array
          description: Technical specifications (17 possible fields - Motor, Transmission, Acceleration, AssembledIn, GroundClearanceInMM, HeightInMM, Horsepower, LengthInMM, LiterPerKM, MaxSpeed, Origin, Speed, TractionType, TrunkSize, WheelBase, WidthInMM, Seats)
          items:
            $ref: '#/components/schemas/SpecItem'
        features:
          type: array
          description: Feature list (simple string array converted to objects)
          items:
            $ref: '#/components/schemas/FeatureItem'

    User:
      type: object
      description: User account information
      required:
        - id
        - email
        - emailVerified
        - createdAt
        - updatedAt
      properties:
        id:
          type: string
          description: User unique identifier
          example: "clx1y2z3a0000abcdefgh1234"
        email:
          type: string
          format: email
          description: User email address
          example: "user@example.com"
        name:
          type: string
          description: User display name
          example: "John Doe"
          nullable: true
        emailVerified:
          type: boolean
          description: Whether the email has been verified
          example: false
        image:
          type: string
          format: uri
          description: User profile image URL
          example: "https://lh3.googleusercontent.com/a/..."
          nullable: true
        createdAt:
          type: string
          format: date-time
          description: Account creation timestamp
          example: "2024-01-15T10:30:00Z"
        updatedAt:
          type: string
          format: date-time
          description: Last update timestamp
          example: "2024-01-15T10:30:00Z"

    SessionInfo:
      type: object
      description: Session information
      required:
        - token
        - userId
        - expiresAt
      properties:
        token:
          type: string
          description: Session token
          example: "session_abc123xyz..."
        userId:
          type: string
          description: User ID associated with this session
          example: "clx1y2z3a0000abcdefgh1234"
        expiresAt:
          type: string
          format: date-time
          description: Session expiration timestamp
          example: "2024-02-15T10:30:00Z"
        ipAddress:
          type: string
          description: IP address of the session
          example: "192.168.1.1"
          nullable: true
        userAgent:
          type: string
          description: User agent string
          example: "Mozilla/5.0..."
          nullable: true

    Session:
      type: object
      description: Complete session response with user information
      required:
        - user
        - session
      properties:
        user:
          $ref: '#/components/schemas/User'
        session:
          $ref: '#/components/schemas/SessionInfo'

    AuthResponse:
      type: object
      description: Authentication response for sign-up and sign-in
      required:
        - token
        - user
      properties:
        redirect:
          type: boolean
          description: Indicates if a redirect is needed
          example: false
        token:
          type: string
          description: Session token
          example: "if7jO3q6OZTDrla7ZIu9HS6B5kPdR9T3"
        user:
          $ref: '#/components/schemas/User'

    Error:
      type: object
      description: Error response
      required:
        - error
      properties:
        error:
          type: string
          description: Error message
          example: "Some error message"
